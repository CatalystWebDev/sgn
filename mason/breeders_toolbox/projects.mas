
<%args>
$projects
</%args>

<div id="add_project_dialog"  class="ui-widget" >

<table><tr><td>Trial name</td><td><input name="project_name" /></td></tr>
<tr><td>Year</td><td><input id="project_year" name="year" /></td></tr>
<tr><td colspan="2">Description</td></tr>
<tr><td colspan="2"><textarea name="project_description" cols="60" >
</textarea>
</td></tr></table>

</div>

<script>
  jQuery('#add_project_dialog').dialog( {
     autoOpen: false,
     buttons:  { "Cancel" : function() { jQuery('#add_project_dialog').dialog("close"); }, 
                     "Add": function() { save_project_info(); } },
     modal: true,
     width: 500,
     height: 300,
     title: "Add new trial"

});

  jQuery('#add_project_link').click( function() { open_project_dialog() } );

  function open_project_dialog() { 
      

     jQuery('#add_project_dialog').dialog("open");
  }

  function save_project_info() { 
     var name = jQuery('#project_name').val();
     var year = jQuery('#project_year').val();
     var desc = jQuery('#project_description').val();

      if (name == '' || year == '') { alert('Name and year are required.');  return; }
   
     new jQuery.ajax( {
       type: 'GET',
       url: '/breeders/project/insert',
       data: { 'project_name': name,  'project_description': desc, 'year': year },

     }).done(alert("Done saving project info"));
     jQuery('#add_project_dialog').dialog("close");
  }
    
  

</script>



<table>


<%perl>



foreach my $p (@$projects){ 
   print "<tr><td>$p->[1]</td><td>$p->[2]</td></tr>\n";
}
</%perl>
</table>
